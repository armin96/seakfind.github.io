<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"seakfind.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="website">
<meta property="og:title" content="seakfind">
<meta property="og:url" content="https://seakfind.github.io/index.html">
<meta property="og:site_name" content="seakfind">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="seakfind">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://seakfind.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>seakfind</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">seakfind</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">seakfind</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/10/19/Split-Tunneling-in-OpenVPN-Client-on-Windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/19/Split-Tunneling-in-OpenVPN-Client-on-Windows/" class="post-title-link" itemprop="url">Split Tunneling in OpenVPN Client on Windows</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-19 00:00:00 / Modified: 04:25:49" itemprop="dateCreated datePublished" datetime="2021-10-19T00:00:00-07:00">2021-10-19</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The official OpenVPN client for Windows offers per-IP split tunneling. Some proprietary clients also offer per-app split tunneling.</p>
<p>To look up IP addresses, open a Windows terminal (Command Prompt or Windows PowerShell) and issue the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup whatismyipaddress.com</span><br></pre></td></tr></table></figure>

<p>Sample response:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Non-authoritative answer:</span><br><span class="line">Name:    whatismyipaddress.com</span><br><span class="line">Addresses:  104.16.155.36</span><br><span class="line">            104.16.154.36</span><br></pre></td></tr></table></figure>

<p>To send only two IP addresses through the VPN tunnel:</p>
<ol>
<li>Disconnect the client from the server</li>
<li>Edit the client configuration file</li>
<li>Add these lines at the end before reconnecting</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">route 104.16.154.36 255.255.255.255 vpn_gateway</span><br><span class="line">route 104.16.155.36 255.255.255.255 vpn_gateway</span><br><span class="line">route 0.0.0.0 192.0.0.0 net_gateway</span><br><span class="line">route 64.0.0.0 192.0.0.0 net_gateway</span><br><span class="line">route 128.0.0.0 192.0.0.0 net_gateway</span><br><span class="line">route 192.0.0.0 192.0.0.0 net_gateway</span><br></pre></td></tr></table></figure>

<p>To send everything <em>except</em> two IP addresses through the VPN tunnel:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">route 104.16.154.36 255.255.255.255 net_gateway</span><br><span class="line">route 104.16.155.36 255.255.255.255 net_gateway</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/10/18/Windows-SoftEther-VPN-Server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/18/Windows-SoftEther-VPN-Server/" class="post-title-link" itemprop="url">Windows SoftEther VPN Server</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-18 18:00:00 / Modified: 18:21:09" itemprop="dateCreated datePublished" datetime="2021-10-18T18:00:00-07:00">2021-10-18</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>This post shows you how to use a Windows computer as a VPN server. This might be helpful in many scenarios. For example:</p>
<ul>
<li>Employees need to connect to a company LAN from outside the office</li>
<li>You want to securely access the Internet from a coffee shop or airport</li>
<li>You have a friend in a foreign country who needs unblocked access to the Internet</li>
</ul>
<p>After you’ve followed along with this tutorial, you’ll have a working L2TP/IPsec server on your Windows computer.</p>
<h2 id="Step-1-Open-Firewall"><a href="#Step-1-Open-Firewall" class="headerlink" title="Step 1. Open Firewall"></a>Step 1. Open Firewall</h2><p>For traffic to reach an L2TP/IPsec server, you need to open ports 500/udp, 1701/udp, and 4500/udp in your computer’s firewall. On your Windows computer, you do that like this:</p>
<ol>
<li>In the Windows search box (next to the Start button), type <code>firewall</code></li>
<li>Select <strong>Windows Defender Firewall with Advanced Security</strong></li>
<li>In the left pane, click <strong>Inbound Rules</strong></li>
<li>In the Actions pane on the right, click <strong>New Rule…</strong></li>
<li>In the New Inbound Rule Wizard window, select <strong>Port</strong>, and click <strong>Next</strong></li>
<li>In the Protocol and Ports window, select <strong>UDP</strong>, and in the <strong>Specific local ports</strong> field, type <code>500, 1701, 4500</code> and click Next</li>
<li>In the Action window, select <strong>Allow the connection</strong>, and click <strong>Next</strong></li>
<li>Check all profiles, and click <strong>Next</strong></li>
<li>Enter a Name such as <code>L2TP/IPsec</code>, and click <strong>Finish</strong></li>
<li>Close the Windows Defender Firewall with Advanced Security</li>
</ol>
<p><img src="/images/se001.png" alt="Windows Defender Firewall with Advanced Security new rule specifying protocol and ports"></p>
<p>In a typical home network, where you are behind a router, you also need to:</p>
<ul>
<li>Open ports 500/udp, 1701/udp, and 4500/udp for input</li>
<li>Port forward these ports from your router to your PC</li>
</ul>
<p>Instructions for doing the above vary from router to router. Consult your router documentation to learn how to do these steps on your particular make and model of router.</p>
<p>One more point about home PCs! You need a Power Plan that ensures your computer will not be asleep when clients try to connect. You can change the power settings on a Windows PC like this:</p>
<ol>
<li>Right-click on the Windows Start button, and select <strong>Settings</strong></li>
<li>Click <strong>System</strong></li>
<li>Select <strong>Power &amp; sleep</strong></li>
<li>Change the settings for <strong>Sleep</strong> to <strong>Never</strong></li>
<li>When you’re done, close the Settings app.</li>
</ol>
<h2 id="Step-2-Download-SoftEther-VPN-Server"><a href="#Step-2-Download-SoftEther-VPN-Server" class="headerlink" title="Step 2. Download SoftEther VPN Server"></a>Step 2. Download SoftEther VPN Server</h2><p>Now for the download of the SoftEther VPN installer:</p>
<ol>
<li>Open a browser</li>
<li>Visit <a target="_blank" rel="noopener" href="https://www.softether.org/">https://www.softether.org</a></li>
<li>Click <strong>Download</strong></li>
<li>Click <strong>Download SoftEther VPN</strong></li>
<li>Select <strong>SoftEther VPN (Freeware)</strong></li>
<li>Select Component <strong>SoftEther VPN Server</strong></li>
<li>Select Platform <strong>Windows</strong></li>
<li>Select CPU <strong>Intel (x86 and x64)</strong></li>
<li>Download the latest build</li>
</ol>
<p><img src="/images/se002.png" alt="Download SoftEther VPN Server for Windows"></p>
<h2 id="Step-3-Run-the-Installer"><a href="#Step-3-Run-the-Installer" class="headerlink" title="Step 3. Run the Installer"></a>Step 3. Run the Installer</h2><p>In your Downloads folder, find the Installer executable. It will have a name that looks like <code>softether-vpnserver_vpnbridge-v4.38-9760-rtm-2021.08.17-windows-x86_x64-intel</code>.</p>
<p>Run the installer executable.</p>
<ol>
<li>Read the initial information screen, then click <strong>Next</strong></li>
<li>If User Account Control pops up, click <strong>Yes</strong> to allow changes to your device</li>
<li>Select software component <strong>SoftEther VPN Server</strong>, and click <strong>Next</strong></li>
<li>Read the End User License Agreement, check the box to agree to the End User License Agreement, and click <strong>Next</strong></li>
<li>Read the Important Notices, and click <strong>Next</strong></li>
<li>Accept the default directory, <code>C:\Program Files\SoftEther VPN Server</code>, and click <strong>Next</strong></li>
<li>On the Ready to Install screen, click <strong>Next</strong></li>
</ol>
<p>Wait while the installer runs. A SoftEther VPN Server Manager icon is created on your desktop. At the end of the installation, leave the box checked to immediately run SoftEther VPN Server Manager, and click <strong>Finish</strong>.</p>
<p><img src="/images/se003.png" alt="SoftEther VPN Setup Wizard finished"></p>
<h2 id="Step-4-Set-the-VPN-Server-Password"><a href="#Step-4-Set-the-VPN-Server-Password" class="headerlink" title="Step 4. Set the VPN Server Password"></a>Step 4. Set the VPN Server Password</h2><p>The SoftEther VPN Server Manager is started for you by the installer.</p>
<p><img src="/images/se004a.png" alt="SoftEther VPN Server Manager"></p>
<p>Leave the server <code>localhost (This server)</code> selected, then press the <strong>Connect</strong> button. The first time you do this, you will be prompted to enter and confirm a password for the server. Click <strong>OK</strong> when you’re done.</p>
<p><img src="/images/se004b.png" alt="SoftEther VPN Server Manager change administrator password"></p>
<p>Click <strong>OK</strong> on seeing the password change confirmation box.</p>
<h2 id="Step-5-SoftEther-VPN-Server-Easy-Setup"><a href="#Step-5-SoftEther-VPN-Server-Easy-Setup" class="headerlink" title="Step 5. SoftEther VPN Server Easy Setup"></a>Step 5. SoftEther VPN Server Easy Setup</h2><p>The first time into the server, a wizard walks you through the SoftEther VPN Server Easy Setup process.</p>
<h3 id="Step-5a-Create-Virtual-Hub"><a href="#Step-5a-Create-Virtual-Hub" class="headerlink" title="Step 5a. Create Virtual Hub"></a>Step 5a. Create Virtual Hub</h3><p>Check the box for Remote Access VPN Server, and click <strong>Next</strong>.</p>
<p><img src="/images/se005.png" alt="SoftEther virtual hub for remote access VPN server"></p>
<p>A message appears saying that the settings of this VPN Server will be initialized. The box asks if you really want to do this. Click <strong>Yes</strong>.</p>
<p>Give the Virtual Hub a Name, such as the default of <code>VPN</code>, and click <strong>OK</strong>.</p>
<h3 id="Step-5b-Dynamic-DNS-Function"><a href="#Step-5b-Dynamic-DNS-Function" class="headerlink" title="Step 5b. Dynamic DNS Function"></a>Step 5b. Dynamic DNS Function</h3><p>SoftEther automatically assigns you a dynamic DNS name. It will look like <code>vpn322055929.softether.net</code>. </p>
<p>Click <strong>Exit</strong>.</p>
<p><img src="/images/se006.png" alt="SoftEther Dynamic DNS Function"></p>
<h3 id="Step-5c-IPsec-L2TP-EtherIP-L2TPv3-Server-Settings"><a href="#Step-5c-IPsec-L2TP-EtherIP-L2TPv3-Server-Settings" class="headerlink" title="Step 5c. IPsec / L2TP / EtherIP/ L2TPv3 Server Settings"></a>Step 5c. IPsec / L2TP / EtherIP/ L2TPv3 Server Settings</h3><p>Check the box for <strong>Enable L2TP Server Function (L2TP over IPsec)</strong>.</p>
<p>Enter a preshared key in the IPsec Pre-Shared Key box. It must be eight characters – for example, <code>abcd1234</code>.</p>
<p>Click <strong>OK</strong>.</p>
<p><img src="/images/se007.png" alt="SoftEther IPsec / L2TP / EtherIP/ L2TPv3 Server Settings"></p>
<h3 id="Step-5d-VPN-Azure-Service-Settings"><a href="#Step-5d-VPN-Azure-Service-Settings" class="headerlink" title="Step 5d. VPN Azure Service Settings"></a>Step 5d. VPN Azure Service Settings</h3><p>Select the radio button for <strong>Disable VPN Azure</strong>.</p>
<p>Click <strong>OK</strong>.</p>
<p><img src="/images/se008.png" alt="SoftEther VPN Azure Service Settings"></p>
<h3 id="Step-5e-Create-User"><a href="#Step-5e-Create-User" class="headerlink" title="Step 5e. Create User"></a>Step 5e. Create User</h3><p>Click the button <strong>Create Users</strong>.</p>
<ol>
<li>Enter a username</li>
<li>Enter the full name for this user</li>
<li>Select Auth Type <strong>Password Authentication</strong></li>
<li>Enter and confirm the password</li>
<li>Click <strong>OK</strong></li>
<li>When the confirmation box appears, click <strong>OK</strong></li>
<li>Since we need only one user for now, click <strong>Exit</strong></li>
</ol>
<p><img src="/images/se009.png" alt="SoftEther create user"></p>
<h3 id="Stef-5f-Enable-SecureNAT"><a href="#Stef-5f-Enable-SecureNAT" class="headerlink" title="Stef 5f. Enable SecureNAT"></a>Stef 5f. Enable SecureNAT</h3><p>SecureNAT function is an innovative proprietary technology developed for SoftEther that enables the creation of a more secure network. SecureNAT provides two functions: virtual NAT and virtual DHCP.</p>
<p>On the screen to manage the VPN server on localhost:</p>
<ol>
<li>Select the row for the default Virtual Hub, which we named just VPN</li>
<li>Click <strong>Manage Virtual Hub</strong></li>
<li>Click <strong>Virtual NAT and Virtual DHCP Server (SecureNAT)</strong></li>
<li>Click <strong>Enable SecureNAT</strong></li>
<li>Click <strong>OK</strong></li>
<li>Click <strong>Exit</strong></li>
<li>Click <strong>Exit</strong></li>
</ol>
<p><img src="/images/se010.png" alt="SoftEther virtual hub with SecureNAT enabled"></p>
<p>You server work is done for now. Let’s test it with your first client.</p>
<h2 id="Step-6-Install-and-Configure-Client"><a href="#Step-6-Install-and-Configure-Client" class="headerlink" title="Step 6. Install and Configure Client"></a>Step 6. Install and Configure Client</h2><p>An L2TP/IPsec client is built in to many devices. We will use a Windows client to test the server. The client PC must be a different PC, and at a different location, from the server PC.</p>
<p>On the <em>client</em> PC, in the Settings app, open the <strong>Network &amp; Internet</strong> section. Select the <strong>VPN</strong> screen. Click <strong>Add VPN</strong>.</p>
<ol>
<li>For the VPN Provider, select <strong>Windows (built-in)</strong></li>
<li>Put a connection name of your choice, e.g. <code>New York</code></li>
<li>For server address, put the one assigned to your server, e.g. <code>vpn322055929.softether.net</code></li>
<li>For the VPN type, select <strong>L2TP/IPsec with pre-shared key</strong></li>
<li>For the Pre-shared key, type the one you specified on the server, e.g. <code>abcd1234</code></li>
<li>For Type of sign-in info, select <strong>User name and password</strong></li>
<li>For the User name, type the one you set up on the server</li>
<li>For the Password, type the one you set up on the server</li>
<li>Check <strong>Remember my sign-in info</strong></li>
<li>Check <strong>Save</strong></li>
</ol>
<p><img src="/images/se012.png" alt="Windows built-in VPN client for L2TP/IPsec with pre-shared key"></p>
<h2 id="Step-7-Test-Client-to-Server-Connnection"><a href="#Step-7-Test-Client-to-Server-Connnection" class="headerlink" title="Step 7. Test Client to Server Connnection"></a>Step 7. Test Client to Server Connnection</h2><p>On the row for the VPN connection you just added, click <strong>Connect</strong>. The status changes to Connected.</p>
<p>Open a browser, and visit <a target="_blank" rel="noopener" href="https://whatismyipaddress.com/">https://whatismyipaddress.com</a>.</p>
<p>You should see the IP address and location of your VPN server, not your client.</p>
<p>Congratulations! </p>
<p>You now have a working VPN server, ready to receive client connections.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/10/10/X-UI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/10/X-UI/" class="post-title-link" itemprop="url">X-UI, a multi-user Xray graphical management panel (replacing V2-UI and V2Ray)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-10 16:06:00 / Modified: 07:43:03" itemprop="dateCreated datePublished" datetime="2021-10-10T16:06:00-07:00">2021-10-10</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>X-UI provides a graphical user interface for managing servers and users. You can visually build servers for Shadowsocks, V2ray, Xray, Trojan, and other popular protocols. You can also monitor VPS performance and traffic usage in real time. X-UI replaces the older V2-UI panel. </p>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><p>Before you begin, you need to do three or four things:</p>
<ol>
<li>Get a virtual private server or VPS. You can get a VPS from many providers. Some popular ones are AWS, Google Cloud, Microsoft Azure, DigitalOcean, Hetzner, and Vultr. In our example we use a Debian 11 VPS, but the X-UI install script supports Ubuntu 16+, Debian 8+, or CentOS 7+. You need to have ports 80 and 443 on your VPS open for TCP input. Also open port 54321 for TCP input.</li>
<li>Get a domain name. Some low-cost registrars are Porkbun, Namesilo, and Namecheap.</li>
<li>Create a DNS <code>A</code> record pointing from your host name to your VPS.</li>
<li>Optionally, add your domain to Cloudflare. This will allow you to insert a content distribution network or CDN in between you and your server. However, if you are going to add a CDN, do not turn on proxying in Cloudflare until the end. For now, just use the DNS features of Cloudflare. Adding your domain to Cloudflare is optional, and you can continue to use your domain name registrar’s nameservers if you prefer. In any case, not all protocols support the use of CDN proxying.</li>
</ol>
<h2 id="Update-Server"><a href="#Update-Server" class="headerlink" title="Update Server"></a>Update Server</h2><p>SSH into your server. On Windows you can use the built-in PowerShell app, or you can install a terminal emulator such as PuTTY or XSHELL.</p>
<p><img src="/images/xui001.png" alt="SSH into a server using XSHELL"></p>
<p>Get your server up to date:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt upgrade -y</span><br></pre></td></tr></table></figure>

<p>Also install <code>curl</code> and <code>socat</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install curl socat -y</span><br></pre></td></tr></table></figure>

<h2 id="Install-Acme-Script"><a href="#Install-Acme-Script" class="headerlink" title="Install Acme Script"></a>Install Acme Script</h2><p>Download and install the Acme script for getting a free SSL certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh | sh</span><br></pre></td></tr></table></figure>

<h2 id="Get-Free-SSL-Certificate"><a href="#Get-Free-SSL-Certificate" class="headerlink" title="Get Free SSL Certificate"></a>Get Free SSL Certificate</h2><p>Set the default provider to Let’s Encrypt:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --set-default-ca --server letsencrypt</span><br></pre></td></tr></table></figure>

<p>Register your account for a free SSL certificate. In the next command, replace <code>xxxx@xxxx.com</code> by your actual email address:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --register-account -m xxxx@xxxx.com</span><br></pre></td></tr></table></figure>

<p>Obtain an SSL certificate. In the next command, replace <code>host.mydomain.com</code> by your actual host name:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --issue -d host.mydomain.com --standalone</span><br></pre></td></tr></table></figure>

<p>After a minute or so, the script terminates. On success, you will receive feedback as to the location of the certificate and key:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Your cert is in: /root/.acme.sh/host.mydomain.com/host.mydomain.com.cer</span><br><span class="line">Your cert key is in: /root/.acme.sh/host.mydomain.com/host.mydomain.com.key</span><br><span class="line">The intermediate CA cert is in: /root/.acme.sh/host.mydomain.com/ca.cer</span><br><span class="line">And the full chain certs is there: /root/.acme.sh/host.mydomain.com/fullchain.cer</span><br></pre></td></tr></table></figure>

<p>You cannot use the certificate and key in their current locations, as these may be temporary. Therefore install the certificate and key to a permanent location. In the next command, replace <code>host.mydomain.com</code> by your actual host name:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.acme.sh/acme.sh --installcert -d host.mydomain.com --key-file /root/private.key --fullchain-file /root/cert.crt</span><br></pre></td></tr></table></figure>

<p><img src="/images/xui002.png" alt="Install certificate and key issued by Acme script"></p>
<h2 id="Run-the-X-UI-Install-Script"><a href="#Run-the-X-UI-Install-Script" class="headerlink" title="Run the X-UI Install Script"></a>Run the X-UI Install Script</h2><p>Download and run the one-click install script provided by the developer:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -Ls https://raw.githubusercontent.com/vaxilu/x-ui/master/install.sh)</span><br></pre></td></tr></table></figure>

<h2 id="Common-Panel-Commands"><a href="#Common-Panel-Commands" class="headerlink" title="Common Panel Commands"></a>Common Panel Commands</h2><p>From the command line, you can control the server with various commands:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Effect</th>
</tr>
</thead>
<tbody><tr>
<td><code>x-ui</code></td>
<td>Display the management menu</td>
</tr>
<tr>
<td><code>x-ui start</code></td>
<td>Start the X-UI panel</td>
</tr>
<tr>
<td><code>x-ui stop</code></td>
<td>Stop the X-UI panel</td>
</tr>
<tr>
<td><code>x-ui restart</code></td>
<td>Restart the X-UI panel</td>
</tr>
<tr>
<td><code>x-ui status</code></td>
<td>View X-UI status</td>
</tr>
<tr>
<td><code>x-ui enable</code></td>
<td>Set X-UI to start automatically after boot</td>
</tr>
<tr>
<td><code>x-ui disable</code></td>
<td>Cancel X-UI boot from start</td>
</tr>
<tr>
<td><code>x-ui log</code></td>
<td>View X-UI log</td>
</tr>
<tr>
<td><code>x-ui update</code></td>
<td>Update the X-UI panel</td>
</tr>
<tr>
<td><code>x-ui install</code></td>
<td>Install X-UI panel</td>
</tr>
<tr>
<td><code>x-ui uninstall</code></td>
<td>Uninstall X-UI panel</td>
</tr>
</tbody></table>
<h2 id="First-Time-Login"><a href="#First-Time-Login" class="headerlink" title="First Time Login"></a>First Time Login</h2><p>You can get to the X-UI panel on your PC by opening a browser and typing your server IP address and port <code>54321</code>. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://123.45.67.89:54321</span><br></pre></td></tr></table></figure>

<p>By default, the login user name is <code>admin</code>, and the password is also <code>admin</code>. </p>
<p><img src="/images/xui003.png" alt="First-time login to X-UI panel"></p>
<h2 id="Side-Menu"><a href="#Side-Menu" class="headerlink" title="Side Menu"></a>Side Menu</h2><p>After you have logged in, the side menu offers these options:</p>
<table>
<thead>
<tr>
<th>Chinese</th>
<th>English</th>
</tr>
</thead>
<tbody><tr>
<td>系统状态</td>
<td>System status</td>
</tr>
<tr>
<td>入站列表</td>
<td>Inbound list</td>
</tr>
<tr>
<td>面板设置</td>
<td>Panel settings</td>
</tr>
<tr>
<td>其他</td>
<td>Other</td>
</tr>
<tr>
<td>退出登录</td>
<td>Sign out</td>
</tr>
</tbody></table>
<p><img src="/images/xui004.png" alt="Side menu on X-UI panel"></p>
<h2 id="Enable-HTTPS-on-Panel"><a href="#Enable-HTTPS-on-Panel" class="headerlink" title="Enable HTTPS on Panel"></a>Enable HTTPS on Panel</h2><p>You will notice that, at first, you used plain text HTTP to reach the panel. This is not secure.</p>
<p>To enable HTTPS, choose <strong>面板设置</strong> (Panel settings).</p>
<p>You will need to specify your certificate and key.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">面板证书公钥文件路径</span><br><span class="line">填写一个 &#x27;/&#x27; 开头的绝对路径，重启面板生效</span><br><span class="line">Panel certificate public key file path</span><br><span class="line">Fill in an absolute path starting with&#x27;/&#x27;, restart the panel to take effect</span><br></pre></td></tr></table></figure>

<p>Fill in <code>/root/cert.crt</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">面板证书密钥文件路径</span><br><span class="line">填写一个 &#x27;/&#x27; 开头的绝对路径，重启面板生效</span><br><span class="line">Panel certificate key file path</span><br><span class="line">Fill in an absolute path starting with&#x27;/&#x27;, restart the panel to take effect </span><br></pre></td></tr></table></figure>

<p>Fill in <code>/root/private.key</code>.</p>
<p><img src="/images/xui005.png" alt="Specifying certificate and key in X-UI panel settings"></p>
<p>Save these options.</p>
<p>Now in your SSH session issue the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x-ui restart</span><br></pre></td></tr></table></figure>

<p>Now you can reach the panel using HTTPS. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://host.mydomain.com:54321</span><br></pre></td></tr></table></figure>

<p><img src="/images/xui006.png" alt="HTTPS login to X-UI panel"></p>
<h2 id="Change-Admin-Password"><a href="#Change-Admin-Password" class="headerlink" title="Change Admin Password"></a>Change Admin Password</h2><p>The default admin user name <code>admin</code> and password <code>admin</code> are the same for all installations. This is not secure. Input the old values of <code>admin</code> and <code>admin</code>, and choose new, unique values:</p>
<table>
<thead>
<tr>
<th>Chinese</th>
<th>English</th>
</tr>
</thead>
<tbody><tr>
<td>原用户名</td>
<td>Original user name</td>
</tr>
<tr>
<td>原密码</td>
<td>Old password</td>
</tr>
<tr>
<td>新用户名</td>
<td>New user name</td>
</tr>
<tr>
<td>新密码</td>
<td>New password</td>
</tr>
</tbody></table>
<p><img src="/images/xui007.png" alt="X-UI panel change user name and password"></p>
<p>Save the new values.</p>
<p>Sign out, then sign in again with the new user name and password.</p>
<p><img src="/images/xui008.png" alt="HTTPS login with new user name and password"></p>
<h2 id="Add-VLESS-XTLS-Xray-User"><a href="#Add-VLESS-XTLS-Xray-User" class="headerlink" title="Add VLESS+XTLS Xray User"></a>Add VLESS+XTLS Xray User</h2><p>We are going to add an inbound user account using VLESS and Xray. VLESS is an an updated version of the older Vmess protocol. After several developers found flaws in Vmess protocol and showed that the Vmess protocol can be detected by deep packet inspection or DPI, VLESS was developed. (Note that it is plain Vmess that can be detected; Vmess+WS+TLS is still secure and supports the use of a CDN.) Xray core was developed as an alternative to the older V2Ray core. According to the Xray developers, Xray is more stable, better for UDP gaming, and 30% faster than V2Ray. XTLS speeds up TLS by reducing double-encryption.</p>
<p>On the side menu, select <strong>入站列表</strong> (Inbound list).</p>
<p>Click the plus sign to add a new inbound user. </p>
<p>The <strong>添加入站</strong> (Add inbound) box appears. </p>
<p>Enter fields as follows.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Contents</th>
</tr>
</thead>
<tbody><tr>
<td>Remark</td>
<td>Put a unique and meaningful description</td>
</tr>
<tr>
<td>Enable</td>
<td>On</td>
</tr>
<tr>
<td>Protocol</td>
<td><code>vless</code></td>
</tr>
<tr>
<td>监听 IP Listening IP</td>
<td>Leave blank</td>
</tr>
<tr>
<td>端口 Port</td>
<td><code>443</code></td>
</tr>
<tr>
<td>总流量(GB) Total bandwidth (GB)</td>
<td><code>0</code> means unlimited</td>
</tr>
<tr>
<td>到期时间 Expiry date</td>
<td>Blank</td>
</tr>
<tr>
<td>Id</td>
<td>Leave the generated UUID as is</td>
</tr>
<tr>
<td>Flow</td>
<td><code>xtls-rprx-direct</code></td>
</tr>
<tr>
<td>Fallbacks</td>
<td>None</td>
</tr>
<tr>
<td>传输 Transmission</td>
<td><code>tcp</code></td>
</tr>
<tr>
<td>HTTP 伪装 masquerading</td>
<td>Off</td>
</tr>
<tr>
<td>TLS</td>
<td>Off</td>
</tr>
<tr>
<td>XTLS</td>
<td>On</td>
</tr>
<tr>
<td>域名 Domain name</td>
<td>Put your host name, e.g. <code>host.mydomain.com</code></td>
</tr>
<tr>
<td>公钥文件路径 Public key file path</td>
<td><code>/root/cert.crt</code></td>
</tr>
<tr>
<td>密钥文件路径 Key file path</td>
<td><code>/root/private.key</code></td>
</tr>
<tr>
<td>Sniffing</td>
<td>On</td>
</tr>
</tbody></table>
<p><img src="/images/xui009.png" alt="Adding a new VLESS+XTLS user"></p>
<p>Save the new user.</p>
<p>Click the <strong>操作</strong> (operating) button at the start of its row to display the QR code for the new user.</p>
<p><img src="/images/xui010.png" alt="Displaying QR code in X-UI panel"></p>
<h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><p>Clients are available for Android, iOS, Windows, macOS, and Linux. Examples are v2rayNG, Shadowrocket, and Qv2ray.</p>
<p>Add the profile in the QR code to your client.</p>
<p><img src="/images/xui011.png" alt="Example of Qv2ray client"></p>
<p>You can check that your connection is working by opening a browser and going to <a target="_blank" rel="noopener" href="https://whatismyipaddress.com/">https://whatismyipaddress.com</a>.</p>
<p><img src="/images/xui012.png" alt="whatismyipaddress.com"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/10/08/Shadowsocks-V2Ray-Plugin-with-Self-Signed-Certificate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/08/Shadowsocks-V2Ray-Plugin-with-Self-Signed-Certificate/" class="post-title-link" itemprop="url">Shadowsocks + V2Ray Plugin with Self-Signed Certificate</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-10-08 22:00:00" itemprop="dateCreated datePublished" datetime="2021-10-08T22:00:00-07:00">2021-10-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-10-09 06:43:27" itemprop="dateModified" datetime="2021-10-09T06:43:27-07:00">2021-10-09</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>By following this post, you can create an SS + V2Ray plugin server without having to buy a domain name.</p>
<p>The server in this post runs Debian 11, and the client runs Windows 11.</p>
<h2 id="Install-Nginx-on-Server"><a href="#Install-Nginx-on-Server" class="headerlink" title="Install Nginx on Server"></a>Install Nginx on Server</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install nginx</span><br></pre></td></tr></table></figure>

<h2 id="Create-Self-Signed-CA-Certificate"><a href="#Create-Self-Signed-CA-Certificate" class="headerlink" title="Create Self-Signed CA Certificate"></a>Create Self-Signed CA Certificate</h2><p>Create a directory to hold your certificates:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/openssl</span><br></pre></td></tr></table></figure>

<p>Change into the directory that will hold your certificates:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/openssl</span><br></pre></td></tr></table></figure>

<p>Generate a private key for your CA certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl ecparam -out ca.key -name secp384r1 -genkey</span><br></pre></td></tr></table></figure>

<p>Generate a certificate signing request:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -sha256 -key ca.key -out ca.csr</span><br></pre></td></tr></table></figure>

<p>Enter anything you like for Country Name, State or Province Name, Locality Name, Organization Name, and Organizational Unit Name. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Country Name (2 letter code) [AU]:</span><br><span class="line">State or Province Name (full name) [Some-State]:NSW</span><br><span class="line">Locality Name (eg, city) []:Sydney</span><br><span class="line">Organization Name (eg, company) [Internet Widgits Pty Ltd]:</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br></pre></td></tr></table></figure>

<p>For Common Name, put <code>Private CA</code>.</p>
<p>Leave Email Address blank.</p>
<p>Leave the ‘extra’ attributes (challenge password and company name) blank.</p>
<p>Sign the certificate signing request, creating your certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -sha256 -days 365 -in ca.csr -signkey ca.key -out ca.crt</span><br></pre></td></tr></table></figure>

<h2 id="Create-Server-Certificate"><a href="#Create-Server-Certificate" class="headerlink" title="Create Server Certificate"></a>Create Server Certificate</h2><p>Generate a private key for your server certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl ecparam -out example.com.key -name secp384r1 -genkey</span><br></pre></td></tr></table></figure>

<p>Generate a certificate signing request:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -sha256 -key example.com.key -out example.com.csr</span><br></pre></td></tr></table></figure>

<p>Enter anything you like for Country Name, State or Province Name, Locality Name, Organization Name, and Organizational Unit Name. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Country Name (2 letter code) [AU]:</span><br><span class="line">State or Province Name (full name) [Some-State]:NSW</span><br><span class="line">Locality Name (eg, city) []:Sydney</span><br><span class="line">Organization Name (eg, company) [Internet Widgits Pty Ltd]:</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br></pre></td></tr></table></figure>

<p>For Common Name, put <code>example.com</code>.</p>
<p>Leave Email Address blank.</p>
<p>Leave the ‘extra’ attributes (challenge password and company name) blank.</p>
<p>Sign the certificate signing request, creating your certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -in example.com.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out example.com.crt -days 365 -sha256</span><br></pre></td></tr></table></figure>

<p>Make the server private key readable by Nginx:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +r example.com.key</span><br></pre></td></tr></table></figure>

<h2 id="Configure-Nginx"><a href="#Configure-Nginx" class="headerlink" title="Configure Nginx"></a>Configure Nginx</h2><p>Generate Diffie-Hellman parameters:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl dhparam -out /etc/nginx/dhparam 2048;</span><br></pre></td></tr></table></figure>

<p>This may take a long time.</p>
<p>Edit the Nginx default site:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure>

<p>Delete the default contents, and enter contents as below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    listen [::]:80 default_server;</span><br><span class="line">    location / &#123;</span><br><span class="line">        return 301 https://$host$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl http2;</span><br><span class="line">    listen [::]:443 ssl http2;</span><br><span class="line">    server_name example.com;</span><br><span class="line">    ssl_certificate /etc/openssl/example.com.crt;</span><br><span class="line">    ssl_certificate_key /etc/openssl/example.com.key;</span><br><span class="line">    ssl_session_timeout 1d;</span><br><span class="line">    ssl_session_cache shared:MozSSL:10m; </span><br><span class="line">    ssl_session_tickets off;</span><br><span class="line">    ssl_dhparam /etc/nginx/dhparam;</span><br><span class="line">    ssl_ecdh_curve secp384r1;</span><br><span class="line">    ssl_protocols TLSv1.2;</span><br><span class="line">    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    </span><br><span class="line">    location /abcdefgh &#123;</span><br><span class="line">	proxy_redirect off;</span><br><span class="line">	proxy_pass http://127.0.0.1:8008;</span><br><span class="line">	proxy_http_version 1.1;</span><br><span class="line">	proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">	proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">	proxy_set_header Host $http_host;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Change <code>/abcdefgh</code> to a secret path of your choice.</p>
<p>Save the configuration file.</p>
<p>Restart Nginx with your revised configuration file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h2 id="Download-V2Ray-Plugin-to-Server"><a href="#Download-V2Ray-Plugin-to-Server" class="headerlink" title="Download V2Ray Plugin to Server"></a>Download V2Ray Plugin to Server</h2><p>Put software v2ray-plugin into directory <code>/usr/bin/</code> like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line"></span><br><span class="line">wget https://github.com/shadowsocks/v2ray-plugin/releases/download/v1.3.1/v2ray-plugin-linux-amd64-v1.3.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar -xf v2ray-plugin-linux-amd64-v1.3.1.tar.gz</span><br><span class="line"></span><br><span class="line">cp v2ray-plugin_linux_amd64 /usr/bin/v2ray-plugin</span><br></pre></td></tr></table></figure>

<h2 id="Install-Shadowsocks-on-Server"><a href="#Install-Shadowsocks-on-Server" class="headerlink" title="Install Shadowsocks on Server"></a>Install Shadowsocks on Server</h2><p>Download the Shadowsocks-libev install script for Debian from GitHub by issuing this command in your terminal emulator:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>

<p>Make the script executable by issuing the command to set the execution bit:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>

<p>Think up a password. Our example is <code>socKsecreT2021%d</code>.</p>
<p>Think up a port number. Our example is <code>8008</code>.</p>
<p>Choose an encryption method. Our example is <code>aes-256-gcm</code>.</p>
<p>Run the install script by issuing the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>

<p>Enter your choise of password, port, and encryption method. Your run of the script will look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#############################################################</span><br><span class="line"># Install Shadowsocks-libev server for Debian or Ubuntu     #</span><br><span class="line"># Intro:  https://teddysun.com/358.html                     #</span><br><span class="line"># Author: Teddysun &lt;i@teddysun.com&gt;                         #</span><br><span class="line"># Github: https://github.com/shadowsocks/shadowsocks-libev  #</span><br><span class="line">#############################################################</span><br><span class="line"></span><br><span class="line">[Info] Latest version: shadowsocks-libev-3.3.5</span><br><span class="line"></span><br><span class="line">Please input password for shadowsocks-libev:</span><br><span class="line">(Default password: teddysun.com):socKsecreT2021%d</span><br><span class="line"></span><br><span class="line">---------------------------</span><br><span class="line">password = socKsecreT2021%d</span><br><span class="line">---------------------------</span><br><span class="line"></span><br><span class="line">Please enter a port for shadowsocks-libev [1-65535]</span><br><span class="line">(Default port: 19302):8008</span><br><span class="line"></span><br><span class="line">---------------------------</span><br><span class="line">port = 8008</span><br><span class="line">---------------------------</span><br><span class="line"></span><br><span class="line">Please select stream cipher for shadowsocks-libev:</span><br><span class="line">1) aes-256-gcm</span><br><span class="line">2) aes-192-gcm</span><br><span class="line">3) aes-128-gcm</span><br><span class="line">4) aes-256-ctr</span><br><span class="line">5) aes-192-ctr</span><br><span class="line">6) aes-128-ctr</span><br><span class="line">7) aes-256-cfb</span><br><span class="line">8) aes-192-cfb</span><br><span class="line">9) aes-128-cfb</span><br><span class="line">10) camellia-128-cfb</span><br><span class="line">11) camellia-192-cfb</span><br><span class="line">12) camellia-256-cfb</span><br><span class="line">13) xchacha20-ietf-poly1305</span><br><span class="line">14) chacha20-ietf-poly1305</span><br><span class="line">15) chacha20-ietf</span><br><span class="line">16) chacha20</span><br><span class="line">17) salsa20</span><br><span class="line">18) rc4-md5</span><br><span class="line">Which cipher you&#x27;d select(Default: aes-256-gcm):1</span><br><span class="line"></span><br><span class="line">---------------------------</span><br><span class="line">cipher = aes-256-gcm</span><br><span class="line">---------------------------</span><br><span class="line"></span><br><span class="line">Press any key to start...or press Ctrl+C to cancel</span><br></pre></td></tr></table></figure>

<p>Press any key to continue.</p>
<p>Wait while the installs and compiles take place. This may take a long time.</p>
<p>At the end of the install script, the parameters are redisplayed:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Congratulations, Shadowsocks-libev server install completed!</span><br><span class="line">Your Server IP        :  123.45.67.89 </span><br><span class="line">Your Server Port      :  8008 </span><br><span class="line">Your Password         :  socKsecreT2021%d </span><br><span class="line">Your Encryption Method:  aes-256-gcm </span><br><span class="line"></span><br><span class="line">Welcome to visit:https://teddysun.com/358.html</span><br><span class="line">Enjoy it!</span><br></pre></td></tr></table></figure>

<h2 id="Configure-Shadowsocks-on-Server"><a href="#Configure-Shadowsocks-on-Server" class="headerlink" title="Configure Shadowsocks on Server"></a>Configure Shadowsocks on Server</h2><p>Edit the Shadowsocks configuration file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/shadowsocks-libev/config.json</span><br></pre></td></tr></table></figure>

<p>Add lines for the plugin and plugin options, like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:8008,</span><br><span class="line">    &quot;password&quot;:&quot;socKsecreT2021%d&quot;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;user&quot;:&quot;nobody&quot;,</span><br><span class="line">    &quot;method&quot;:&quot;aes-256-gcm&quot;,</span><br><span class="line">    &quot;fast_open&quot;:false,</span><br><span class="line">    &quot;nameserver&quot;:&quot;1.0.0.1&quot;,</span><br><span class="line">    &quot;mode&quot;:&quot;tcp_and_udp&quot;,</span><br><span class="line">    &quot;plugin&quot;:&quot;/usr/bin/v2ray-plugin&quot;,</span><br><span class="line">    &quot;plugin_opts&quot;:&quot;server;path=/abcdefgh&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Remember the comma after what used to be the last option.</p>
<p>Save the edited file.</p>
<h2 id="Restart-Shadowsocks-on-Server"><a href="#Restart-Shadowsocks-on-Server" class="headerlink" title="Restart Shadowsocks on Server"></a>Restart Shadowsocks on Server</h2><p>Restart Shadowsocks with your configuration file which now specifies the V2Ray plugin:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks restart</span><br></pre></td></tr></table></figure>

<p>End work on server:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<h2 id="Download-CA-Certificate-to-Client"><a href="#Download-CA-Certificate-to-Client" class="headerlink" title="Download CA Certificate to Client"></a>Download CA Certificate to Client</h2><p>Now you are going to work on the Windows PC that will be your client. </p>
<p>Open Windows PowerShell (right-click on Windows Start button, then select <strong>Windows Terminal</strong>).</p>
<p>Issue the command below, replacing <code>123.45.67.89</code> by your actual server IP address:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp root@123.45.67.89:/etc/openssl/ca.crt Downloads/ca.crt</span><br></pre></td></tr></table></figure>

<p>Close Windows PowerShell.</p>
<h2 id="Import-CA-Certificate-on-Client"><a href="#Import-CA-Certificate-on-Client" class="headerlink" title="Import CA Certificate on Client"></a>Import CA Certificate on Client</h2><p>Open a Run box (<strong>Win</strong>+<strong>r</strong>), type <code>mmc</code>, and click <strong>OK</strong>.</p>
<p>In the Microsoft Management Console:</p>
<ol>
<li>Click <strong>File</strong></li>
<li>Select the option <strong>Add/Remove Snap-in</strong></li>
<li>In the window <strong>Add or Remove Snap-ins</strong>, select <strong>Certificates</strong></li>
<li>Click the <strong>Add</strong> button</li>
<li>Select <strong>Computer account</strong>, and click <strong>Next</strong></li>
<li>Select <strong>Local computer</strong>, and click <strong>Finish</strong></li>
<li>Click <strong>OK</strong></li>
</ol>
<p>Expand the tree in the left pane. Then continue like this:</p>
<ol>
<li>Right-click on <strong>Trusted Root Certification Authorities</strong></li>
<li>Select <strong>All Tasks</strong> </li>
<li>Select <strong>Import</strong></li>
<li>Click <strong>Next</strong></li>
<li>Browse to your <code>ca.crt</code> file in the <code>Downloads</code> folder</li>
<li>Click <strong>Open</strong></li>
<li>Click <strong>Next</strong></li>
<li>Click <strong>Next</strong></li>
<li>Click <strong>Finish</strong></li>
<li>Click <strong>OK</strong></li>
</ol>
<p>Close the Microsoft Management Console.</p>
<h2 id="Download-Shadowsocks-to-Windows-Client"><a href="#Download-Shadowsocks-to-Windows-Client" class="headerlink" title="Download Shadowsocks to Windows Client"></a>Download Shadowsocks to Windows Client</h2><p>Open a browser and go to <a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-windows/releases">https://github.com/shadowsocks/shadowsocks-windows/releases</a>.</p>
<p>Download the most recent release of Shadowsocks for Windows. For example, right now the most recent release is <code>Shadowsocks-4.4.0.185.zip</code>.</p>
<p>Unzip <code>Shadowsocks-4.4.0.185.zip</code>. This creates a folder <code>Downloads\Shadowsocks-4.4.0.185</code>.</p>
<h2 id="Install-7-Zip"><a href="#Install-7-Zip" class="headerlink" title="Install 7-Zip"></a>Install 7-Zip</h2><p>Install 7-Zip from <a target="_blank" rel="noopener" href="https://www.7-zip.org/">https://www.7-zip.org</a> if you do not have it on your PC already.</p>
<h2 id="Download-V2Ray-Plugin-to-Windows-Client"><a href="#Download-V2Ray-Plugin-to-Windows-Client" class="headerlink" title="Download V2Ray Plugin to Windows Client"></a>Download V2Ray Plugin to Windows Client</h2><p>In your browser, download the most recent V2Ray plugin for Windows from <a target="_blank" rel="noopener" href="https://github.com/shadowsocks/v2ray-plugin/releases">https://github.com/shadowsocks/v2ray-plugin/releases</a>. It will be named something like <code>v2ray-plugin-windows-amd64-v1.3.1.tar.gz</code>.</p>
<p>Right-click on the download, and use 7-Zip to extract <code>v2ray-plugin-windows-amd64-v1.3.1.tar</code>.</p>
<p>Right-click on that, and use 7-Zip again to extract from this the application <code>v2ray-plugin_windows_amd64.exe</code>.</p>
<p>Copy <code>v2ray-plugin_windows_amd64.exe</code> into the Shadowsocks folder <code>Downloads\Shadowsocks-4.4.0.185</code>.</p>
<h2 id="Configure-Shadowsocks-on-Windows-Client"><a href="#Configure-Shadowsocks-on-Windows-Client" class="headerlink" title="Configure Shadowsocks on Windows Client"></a>Configure Shadowsocks on Windows Client</h2><p>Start <code>Shadowsocks.exe</code> for the first time.</p>
<p>When the <strong>Edit Servers</strong> box appears:</p>
<ul>
<li>For Server IP, put the IP address of your server, e.g. <code>123.45.67.89</code></li>
<li>For Server Port, put <code>443</code></li>
<li>For Password put your chosen password, e.g. <code>socKsecreT2021%d</code></li>
<li>For Encryption, select your chosen method, e.g. <code>aes-256-gcm</code></li>
<li>For Plugin Program, put <code>v2ray-plugin_windows_amd64.exe</code></li>
<li>For Plugin Options, put <code>path=/abcdefgh;host=example.com;tls</code></li>
<li>Replacing <code>/abcdefgh</code> in the above by the secret path you configured Nginx to use</li>
</ul>
<p>Click <strong>Apply</strong>.</p>
<p><img src="/images/ss-v2ray-plugin-windows-client.png" alt="Shadowsocks with V2Ray plugin specified on Windows client"></p>
<p>Click <strong>OK</strong>.</p>
<h2 id="Install-Firefox-Browser"><a href="#Install-Firefox-Browser" class="headerlink" title="Install Firefox Browser"></a>Install Firefox Browser</h2><p>If you do not already have Firefox installed, install Firefox now from <a target="_blank" rel="noopener" href="https://www.mozilla.org/en-US/firefox/new">https://www.mozilla.org/en-US/firefox/new</a>.</p>
<h2 id="Configure-Firefox-Browser"><a href="#Configure-Firefox-Browser" class="headerlink" title="Configure Firefox Browser"></a>Configure Firefox Browser</h2><p>From the Firefox hamburger menu, choose <strong>Settings</strong>.</p>
<p>In <strong>Settings</strong>, on the <strong>General</strong> page, under <strong>Network Settings</strong>, click <strong>Settings</strong>.</p>
<p>Configure Firefox to use a Manual proxy configuration.</p>
<p>Specify the SOCKS Host at IP address <code>127.0.0.1</code>, Port <code>1080</code>. </p>
<p>Check the box to proxy DNS requests when using SOCKS v5.</p>
<p>Click <strong>OK</strong>.</p>
<h2 id="Test-Windows-Client-to-Server-Connection"><a href="#Test-Windows-Client-to-Server-Connection" class="headerlink" title="Test Windows Client to Server Connection"></a>Test Windows Client to Server Connection</h2><p>In Firefox, visit <a target="_blank" rel="noopener" href="https://whatismyipaddress.com/">https://whatismyipaddress.com</a>.</p>
<p>You should see the IP address and location of your server, not your client.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/10/08/Xray-Vmess-TLS-WS-with-Self-Signed-Certificate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/08/Xray-Vmess-TLS-WS-with-Self-Signed-Certificate/" class="post-title-link" itemprop="url">Xray Vmess + TLS + WS with Self-Signed Certificate</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-10-08 16:00:00 / Modified: 16:54:39" itemprop="dateCreated datePublished" datetime="2021-10-08T16:00:00-07:00">2021-10-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Xray is a fork of V2Ray. By following this post, you can create an Xray Vmess + TLS + WebSocket server without having to buy a domain name.</p>
<p>The server in this post runs Debian 11, and the client runs Windows 11.</p>
<h2 id="Install-Nginx-on-Server"><a href="#Install-Nginx-on-Server" class="headerlink" title="Install Nginx on Server"></a>Install Nginx on Server</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install nginx</span><br></pre></td></tr></table></figure>

<h2 id="Create-Self-Signed-Certificate"><a href="#Create-Self-Signed-Certificate" class="headerlink" title="Create Self-Signed Certificate"></a>Create Self-Signed Certificate</h2><p>Create a directory to hold your certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/openssl</span><br></pre></td></tr></table></figure>

<p>Change into the directory that will hold your certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/openssl</span><br></pre></td></tr></table></figure>

<p>Generate a private key for your certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl ecparam -out example.com.key -name secp384r1 -genkey</span><br></pre></td></tr></table></figure>

<p>Generate a certificate signing request:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -sha256 -key example.com.key -out example.com.csr</span><br></pre></td></tr></table></figure>

<p>Enter anything you like for Country Name, State or Province Name, Locality Name, Organization Name, and Organizational Unit Name. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Country Name (2 letter code) [AU]:</span><br><span class="line">State or Province Name (full name) [Some-State]:NSW</span><br><span class="line">Locality Name (eg, city) []:Sydney</span><br><span class="line">Organization Name (eg, company) [Internet Widgits Pty Ltd]:</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br></pre></td></tr></table></figure>

<p>For Common Name, put <code>example.com</code>.</p>
<p>Leave Email Address blank.</p>
<p>Leave the ‘extra’ attributes (challenge password and company name) blank.</p>
<p>Sign the certificate signing request, creating your certificate:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -sha256 -days 365 -in example.com.csr -signkey example.com.key -out example.com.crt</span><br></pre></td></tr></table></figure>

<p>Make the server private key readable:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +r example.com.key</span><br></pre></td></tr></table></figure>

<h2 id="Configure-Nginx"><a href="#Configure-Nginx" class="headerlink" title="Configure Nginx"></a>Configure Nginx</h2><p>Generate Diffie-Hellman parameters:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl dhparam -out /etc/nginx/dhparam 2048;</span><br></pre></td></tr></table></figure>

<p>This may take a long time.</p>
<p>Edit the Nginx default site:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure>

<p>Delete the default contents, and enter contents as below:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    listen [::]:80 default_server;</span><br><span class="line">    location / &#123;</span><br><span class="line">        return 301 https://$host$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl http2;</span><br><span class="line">    listen [::]:443 ssl http2;</span><br><span class="line">    ssl_certificate /etc/openssl/example.com.crt;</span><br><span class="line">    ssl_certificate_key /etc/openssl/example.com.key;</span><br><span class="line">    ssl_session_timeout 1d;</span><br><span class="line">    ssl_session_cache shared:MozSSL:10m; </span><br><span class="line">    ssl_session_tickets off;</span><br><span class="line">    ssl_dhparam /etc/nginx/dhparam;</span><br><span class="line">    ssl_protocols TLSv1.2;</span><br><span class="line">    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;</span><br><span class="line">    </span><br><span class="line">    location /abcdefgh &#123;</span><br><span class="line">	proxy_redirect off;</span><br><span class="line">	proxy_pass http://127.0.0.1:12345;</span><br><span class="line">	proxy_http_version 1.1;</span><br><span class="line">	proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">	proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">	proxy_set_header Host $http_host;</span><br><span class="line">	proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Change <code>/abcdefgh</code> to a secret path of your choice.</p>
<p>Save the configuration file.</p>
<p>Restart Nginx:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h2 id="Install-V2Ray-on-Server"><a href="#Install-V2Ray-on-Server" class="headerlink" title="Install V2Ray on Server"></a>Install V2Ray on Server</h2><p>Change back to the home directory:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br></pre></td></tr></table></figure>

<p>Download the installation script:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/XTLS/Xray-install/main/install-release.sh</span><br></pre></td></tr></table></figure>

<p>Make the install script executable:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x install-release.sh</span><br></pre></td></tr></table></figure>

<p>Run the installer:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./install-release.sh</span><br></pre></td></tr></table></figure>

<h2 id="Configure-V2Ray-on-Server"><a href="#Configure-V2Ray-on-Server" class="headerlink" title="Configure V2Ray on Server"></a>Configure V2Ray on Server</h2><p>Edit the configuration file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/local/etc/xray/config.json</span><br></pre></td></tr></table></figure>

<p>Delete existing contents and insert as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;log&quot;: &#123;</span><br><span class="line">    &quot;loglevel&quot;: &quot;warning&quot;,</span><br><span class="line">    &quot;access&quot;: &quot;/var/log/xray/access.log&quot;, </span><br><span class="line">    &quot;error&quot;: &quot;/var/log/xray/error.log&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;inbounds&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;port&quot;: 12345, </span><br><span class="line">      &quot;listen&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">      &quot;protocol&quot;: &quot;vmess&quot;,</span><br><span class="line">      &quot;settings&quot;: &#123;</span><br><span class="line">        &quot;clients&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;id&quot;: &quot;abe98b93-bd82-432f-8a41-0328a8aa5f5a&quot;,  </span><br><span class="line">            &quot;alterId&quot;: 64</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;streamSettings&quot;: &#123;</span><br><span class="line">        &quot;network&quot;: &quot;ws&quot;,</span><br><span class="line">        &quot;wsSettings&quot;: &#123;</span><br><span class="line">          &quot;path&quot;: &quot;/abcdefgh&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;outbounds&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;protocol&quot;: &quot;freedom&quot;,</span><br><span class="line">      &quot;settings&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Change <code>/abcdefgh</code> to the secret path of your choice that you configured Nginx to use.</p>
<p>Change <code>abe98b93-bd82-432f-8a41-0328a8aa5f5a</code> to the UUID of your choice.</p>
<p>Save the file with your edits.</p>
<h2 id="Restart-V2Ray-on-Server"><a href="#Restart-V2Ray-on-Server" class="headerlink" title="Restart V2Ray on Server"></a>Restart V2Ray on Server</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart xray</span><br></pre></td></tr></table></figure>

<p>End work on server:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<h2 id="Download-V2Ray-to-Windows-Client"><a href="#Download-V2Ray-to-Windows-Client" class="headerlink" title="Download V2Ray to Windows Client"></a>Download V2Ray to Windows Client</h2><p>Now work on your Windows PC that will be the client.</p>
<p>Open a browser and go to <a target="_blank" rel="noopener" href="https://github.com/XTLS/Xray-core/releases">https://github.com/XTLS/Xray-core/releases</a>.</p>
<p>Download the most recent release of <code>Xray-windows-64.zip</code>.</p>
<p>Unzip <code>Xray-windows-64.zip</code>.</p>
<h2 id="Configure-Xray-on-Windows-Client"><a href="#Configure-Xray-on-Windows-Client" class="headerlink" title="Configure Xray on Windows Client"></a>Configure Xray on Windows Client</h2><p>Copy and paste the configuration below into Windows Notepad:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;inbounds&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;port&quot;: 1080,</span><br><span class="line">      &quot;listen&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">      &quot;protocol&quot;: &quot;socks&quot;,</span><br><span class="line">      &quot;sniffing&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;destOverride&quot;: [&quot;http&quot;, &quot;tls&quot;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;settings&quot;: &#123;</span><br><span class="line">        &quot;auth&quot;: &quot;noauth&quot;,</span><br><span class="line">        &quot;udp&quot;: false</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;outbounds&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;protocol&quot;: &quot;vmess&quot;,</span><br><span class="line">      &quot;settings&quot;: &#123;</span><br><span class="line">        &quot;vnext&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;address&quot;: &quot;123.45.67.89&quot;,</span><br><span class="line">            &quot;port&quot;: 443,</span><br><span class="line">            &quot;users&quot;: [</span><br><span class="line">              &#123;</span><br><span class="line">                &quot;id&quot;: &quot;abe98b93-bd82-432f-8a41-0328a8aa5f5a&quot;,</span><br><span class="line">                &quot;alterId&quot;: 64</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;streamSettings&quot;: &#123;</span><br><span class="line">        &quot;network&quot;: &quot;ws&quot;,</span><br><span class="line">        &quot;security&quot;: &quot;tls&quot;,</span><br><span class="line">        &quot;tlsSettings&quot;: &#123;</span><br><span class="line">          &quot;allowInsecure&quot;: true,</span><br><span class="line">          &quot;serverName&quot;: &quot;example.com&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;wsSettings&quot;: &#123;</span><br><span class="line">          &quot;path&quot;: &quot;/abcdefgh&quot;,</span><br><span class="line">          &quot;headers&quot;: &#123;</span><br><span class="line">            &quot;Host&quot;: &quot;example.com&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Replace <code>123.45.67.89</code> by your server IP address.</p>
<p>Change <code>/abcdefgh</code> to the secret path of your choice that you configured Nginx to use.</p>
<p>Change <code>abe98b93-bd82-432f-8a41-0328a8aa5f5a</code> to the UUID of your choice.</p>
<p>Save this in a file named <code>config.json</code> (with <em>no</em> <code>.txt</code> on the end) in the same folder as the Xray application, <code>Downloads\Xray-windows-64</code>.</p>
<p>Close Notepad.</p>
<h2 id="Connect-Windows-Client-to-Server"><a href="#Connect-Windows-Client-to-Server" class="headerlink" title="Connect Windows Client to Server"></a>Connect Windows Client to Server</h2><p>Open the Windows Run box with <strong>Win</strong>+<strong>r</strong>, type <code>cmd</code>, and click <strong>OK</strong>. This opens a Windows Command Prompt.</p>
<p>Change into the Xray directory:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd Downloads\Xray-windows-64</span><br></pre></td></tr></table></figure>

<p>Run Xray with your configuration file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xray.exe -c config.json</span><br></pre></td></tr></table></figure>

<p>If Windows Defender Firewall intervenes, click <strong>Allow access</strong>.</p>
<h2 id="Install-Firefox-Browser"><a href="#Install-Firefox-Browser" class="headerlink" title="Install Firefox Browser"></a>Install Firefox Browser</h2><p>If you do not already have Firefox installed, install Firefox now from <a target="_blank" rel="noopener" href="https://www.mozilla.org/en-US/firefox/new">https://www.mozilla.org/en-US/firefox/new</a>.</p>
<h2 id="Configure-Firefox-Browser"><a href="#Configure-Firefox-Browser" class="headerlink" title="Configure Firefox Browser"></a>Configure Firefox Browser</h2><p>In <strong>Settings</strong>, under <strong>Network Settings</strong>, configure Firefox to use a SOCKSv5 proxy server at IP address <code>127.0.0.1</code>, port <code>1080</code>. Check the box to proxy DNS requests when using SOCKS v5.</p>
<h2 id="Test-Windows-Client-to-Server-Connection"><a href="#Test-Windows-Client-to-Server-Connection" class="headerlink" title="Test Windows Client to Server Connection"></a>Test Windows Client to Server Connection</h2><p>In Firefox, visit <a target="_blank" rel="noopener" href="https://whatismyipaddress.com/">https://whatismyipaddress.com</a>.</p>
<p>You should see the IP address and location of your server, not your client.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/09/23/Build-Your-Own-Shadowsocks-Server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/23/Build-Your-Own-Shadowsocks-Server/" class="post-title-link" itemprop="url">Build Your Own Shadowsocks Server</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-09-23 16:00:00" itemprop="dateCreated datePublished" datetime="2021-09-23T16:00:00-07:00">2021-09-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-09-26 17:26:47" itemprop="dateModified" datetime="2021-09-26T17:26:47-07:00">2021-09-26</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Shadowsocks is one of the easiest tools you can use for censorship circumvention. In this tutorial, you’ll learn how to set up your own Shadowsocks server. You’ll also see how to connect to your server from a Windows client.</p>
<p>For ease and convenience, we’ll use a prewritten script to carry out the installation.</p>
<p>The version of Shadowsocks we install here is Shadowsocks-libev. This version is characterized by small memory footprint and is written in the C programming language for low CPU consumption. It is so efficient you can even run it on a router.</p>
<p>The tutorial demonstrates the set-up of a single-user Shadowsocks server. Shadowsocks-libev does not support multiple users each on their own port. If you need multiple users and ports, please install the Python, Go, or Rust version of Shadowsocks. The only way you can support multiple ports with Shadowsocks-libev is to create multiple instances of Shadowsocks.</p>
<p>So let’s get started.</p>
<h2 id="Research-VPS-Providers"><a href="#Research-VPS-Providers" class="headerlink" title="Research VPS Providers"></a>Research VPS Providers</h2><p>You’re going to need to do some research first. To run Shadowsocks, you need both a client and a server. You already have a client, which is your PC. But you need to rent a virtual private server, or VPS, to run the Shadowsocks server. Therefore you must research possible VPS providers. There are hundreds of them out there. We’ll mention only a few.</p>
<p>Enterprise VPS providers aim to provide servers reliable enough for a business to depend on. The top enterprise VPS providers are <a target="_blank" rel="noopener" href="https://aws.amazon.com/">Amazon</a>, <a target="_blank" rel="noopener" href="https://azure.microsoft.com/">Microsoft</a>, and <a target="_blank" rel="noopener" href="https://cloud.google.com/">Google</a>. Usually they offer a free trial for a limited time. After the free trial is over, they can become expensive. A fixed-cost alternative is <a target="_blank" rel="noopener" href="https://aws.amazon.com/lightsail">Amazon Lightsail</a>. <a target="_blank" rel="noopener" href="https://www.oracle.com/cloud">Oracle</a> is currently advertising an “always free” tier of services. </p>
<p>All the enterprise VPS providers require you to input a credit card number so that they can eventually bill you. Some of the mid-tier and smaller providers accept PayPal. </p>
<p>Mid-tier providers are less expensive than the enterprise VPS providers. Examples are <a target="_blank" rel="noopener" href="https://www.digitalocean.com/">DigitalOcean</a>, <a target="_blank" rel="noopener" href="https://www.linode.com/">Linode</a>, <a target="_blank" rel="noopener" href="https://www.vultr.com/">Vultr</a>, <a target="_blank" rel="noopener" href="https://www.hetzner.com/">Hetzner</a>, <a target="_blank" rel="noopener" href="https://www.exoscale.com/">Exoscale</a>, <a target="_blank" rel="noopener" href="https://www.ovhcloud.com/">OVH</a>, <a target="_blank" rel="noopener" href="https://ramnode.com/">RamNode</a>, <a target="_blank" rel="noopener" href="https://www.lunanode.com/">LunaNode</a>, and <a target="_blank" rel="noopener" href="https://bandwagonhost.com/">Bandwagon Host</a>.</p>
<p>The cheapest possibility is to use a low-end provider where one public IPv4 address is shared among many customers. The provider performs network address translation, or NAT, to map your private IPv4 address to the public IPv4 address. For IPv6, you still get one or more addresses that are exclusive to your server. Because IPv4 addresses are in short supply, the cost of an IPv4 address makes up a significant part of the cost of your VPS. By sharing an IPv4 address, the NAT IPv4 VPS providers can get the cost down to just a few dollars per year. Some common ones are <a target="_blank" rel="noopener" href="https://webhorizon.in/">WebHorizon</a>, <a target="_blank" rel="noopener" href="https://hosting.gullo.me/">Gullo</a>, <a target="_blank" rel="noopener" href="https://mrvm.net/">Mr. VM</a>, and <a target="_blank" rel="noopener" href="https://inceptionhosting.com/">Inception Hosting</a>.</p>
<h2 id="Avoid-Blocked-IP-Addresses"><a href="#Avoid-Blocked-IP-Addresses" class="headerlink" title="Avoid Blocked IP Addresses"></a>Avoid Blocked IP Addresses</h2><p>Countries that aggressively censor the Internet sometimes block the entire IP addresse range of common VPS providers. They may also block individual IP addresses if they discover a IP address hosts a Shadowsocks server.</p>
<p>Make sure the provider you choose is not blocked in your country. If there is a risk of individual IP addresses being blocked, make sure your intended provider allows you to cheaply and easily change IP address.</p>
<h2 id="Choose-VPS-Size-and-Linux-Distribution"><a href="#Choose-VPS-Size-and-Linux-Distribution" class="headerlink" title="Choose VPS Size and Linux Distribution"></a>Choose VPS Size and Linux Distribution</h2><p>Shadowsocks will run in 128 MB of RAM. The smallest size of VPS you can rent will be more than adequate. For most VPS providers, that means 512 MB or 1 GB. For NAT IPv4 VPS providers, you can run Shadowsocks on a 128 MB VPS under OpenVZ.</p>
<p>Check your intended VPS provider to see if they offer enough bandwidth for you. Each package will specify a monthly bandwidth limit.</p>
<p>When it comes to choosing a Linux distribution, we recommend either Debian or Ubuntu. The rest of this tutorial uses Debian 10.</p>
<h2 id="Choose-VPS-Provider-and-Package"><a href="#Choose-VPS-Provider-and-Package" class="headerlink" title="Choose VPS Provider and Package"></a>Choose VPS Provider and Package</h2><p>Based on your research, choose a VPS provider and package that meets your needs.</p>
<p>The rest of this tutorial illustrates the Shadowsocks installation process on a 1 GB VPS from Digital Ocean running Debian 10.</p>
<h2 id="Create-VPS"><a href="#Create-VPS" class="headerlink" title="Create VPS"></a>Create VPS</h2><p>DigitalOcean uses the word “droplet” for what other providers call a “VPS” or “instance.”</p>
<p>Whatever provider you’re working on, you’ll need to go through the process to create your VPS. Here is the sequence of choices you’ll make to create a “droplet (or VPS) on DigitalOcean. You’ll make similar choices on other VPS providers.</p>
<ol>
<li>Select a Linux distribution (Debian 10 in our example)</li>
<li>Choose a plan (e.g. Basic)</li>
<li>Select a CPU option (e.g. Regular Intel with SSD)</li>
<li>Add block storage (we do not need any extra volumes for this tutorial)</li>
<li>Choose a region near you (e.g. New York 3)</li>
<li>Choose a VPC network (e.g. default-nyc3)</li>
<li>Select additional options (choose whichever you want)</li>
<li>Authentication method (e.g. choose password, then type a strong root password)</li>
<li>Number of droplets (e.g. 1)</li>
<li>Choose a hostname (e.g. the default, debian-s-1vcpu-1gb-nyc3-01, will do)</li>
<li>Select a project (e.g. the default)</li>
<li>Add backups (you can leave this option unchecked unless you need a regular backup of your server)</li>
</ol>
<p>Click <strong>Create Droplet</strong>.</p>
<p>It takes about a minute to create the VPS. Once it’s created, its public IPv4 address is displayed on your dashboard. You’ll need that in a moment.</p>
<h2 id="Install-Terminal-Emulator"><a href="#Install-Terminal-Emulator" class="headerlink" title="Install Terminal Emulator"></a>Install Terminal Emulator</h2><p>To log in to your server, you’ll need a terminal emulator. On macOS or Linux, your computer already includes a terminal emulator application. On Windows, you have various choices:</p>
<ul>
<li>Windows PowerShell</li>
<li><a target="_blank" rel="noopener" href="https://www.chiark.greenend.org.uk/~sgtatham/putty">PuTTY</a> </li>
<li><a target="_blank" rel="noopener" href="https://www.netsarang.com/en/xshell">XSHELL 7</a></li>
</ul>
<p>Choose your terminal emulator. If you’re going to use a native terminal application, such as the SSH command in Windows PowerShell), there is nothing extra to install. If you choose a non-native application, download and install the software of your choice. </p>
<h2 id="SSH-into-Server"><a href="#SSH-into-Server" class="headerlink" title="SSH into Server"></a>SSH into Server</h2><p>Secure Shell (SSH) is an encrypted network protocol for operating network services securely over an unsecure network. Remote command execution is a typical application. You’ll use SSH to log in to your VPS and execute the commands to install, configure, and monitor Shadowsocks.</p>
<p>SSH into your server now, using your chosen terminal emulator. In a command-line terminal emulator, you would use the <code>ssh</code> command. </p>
<h2 id="Switch-User-to-Root"><a href="#Switch-User-to-Root" class="headerlink" title="Switch User to Root"></a>Switch User to Root</h2><p>We assume you logged in as the root user. If you are not root, you will have to switch user to root.</p>
<p>If you know the root password, you can skip ahead one command to the point where you switch user to root. </p>
<p>If you do not know the root password, you will have to set it with the <code>passwd</code> command. This needs to be prefixed by <code>sudo</code>. <code>sudo</code> is a program for Unix-like computer operating systems that allows users to run programs with the security privileges of another user, by default the root or super user. It originally stood for “superuser do”:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure>

<p>Set the password to something you know. You’ll need to enter the new password again to confirm it.</p>
<p>Now you know the root password, switch user to root:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su -</span><br></pre></td></tr></table></figure>

<p>Enter root password. You are now root.</p>
<h2 id="Update-Server"><a href="#Update-Server" class="headerlink" title="Update Server"></a>Update Server</h2><p>Your VPS was created from an image that may be out of date. Therefore, before you install any extra software, get your existing software up to date. Update its list of packages:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure>

<p>The upgrade your software, based on the updated package lists:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt upgrade</span><br></pre></td></tr></table></figure>

<p>In future you can concatenate these two commands in one line, like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt upgrade</span><br></pre></td></tr></table></figure>

<p>The ampersand-ampersand operator means execute the second command, but only if the first command was successul. The second command will execute if the first command exited with a status code of zero, meaning success. If the exit status of the first command is non-zero, the second command will not be executed.</p>
<h2 id="Protect-Port-22"><a href="#Protect-Port-22" class="headerlink" title="Protect Port 22"></a>Protect Port 22</h2><p>If you’ve never administered a server before, you’ll quickly learn that some people go round and round the Internet, trying to break in to every server in existence. That includes yours. It’s vital that you protect you server’s port 22, the port used to SSH into your server.</p>
<p>You can protect your server with a piece of software called <code>fail2ban</code>. Fail2ban is intrusion-prevention software that protects a server from hackers. It monitors log files for certain entries and takes action based on what it finds. In our case, Fail2ban will temporarily ban any IP address that makes too many failed login attempts too quickly.</p>
<p>There’s an extra little twist that applies on Debian 10 servers. Fail2ban uses firewall software called <code>iptables</code>. On Debian 10, iptables is in a state of transition from legacy to current. To avoid confusion, explicitly specify that any reference to <code>iptables</code> means the old version:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives --set iptables /usr/sbin/iptables-legacy</span><br></pre></td></tr></table></figure>

<p>Do the same thing for the IPv6 firewall using ip6tables:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives --set ip6tables /usr/sbin/ip6tables-legacy</span><br></pre></td></tr></table></figure>

<p>Now you can install <code>fail2ban</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install fail2ban</span><br></pre></td></tr></table></figure>

<p>Fail2ban creates and manages extra <code>iptables</code> rules to temporarily block IP addresses with too many failed login attempts.</p>
<p><img src="/images/ss-fail2ban.png" alt="iptables rules managed by fail2ban"></p>
<h2 id="Open-Firewall-for-Shadowsocks"><a href="#Open-Firewall-for-Shadowsocks" class="headerlink" title="Open Firewall for Shadowsocks"></a>Open Firewall for Shadowsocks</h2><p>You have not yet specified any firewall rules except those that <code>fail2ban</code> created to limit bad login attempts. However, some VPS providers implement a system of security groups outside of the server’s <code>iptables</code> rules.</p>
<p>The script you run in a few minutes is going to randomly generate a port number between <code>9000</code> and <code>19999</code> for Shadowsocks. If your VPS providers uses security groups, you’ll need to open the security groups for input on ports <code>9000</code> through <code>19999</code>. Note that, by default, Shadowsocks will listen on both TCP and UDP on its selected port.</p>
<h2 id="Choose-a-Password-for-Shadowsocks"><a href="#Choose-a-Password-for-Shadowsocks" class="headerlink" title="Choose a Password for Shadowsocks"></a>Choose a Password for Shadowsocks</h2><p>The script is going to suggest a default password of <code>teddysun.com</code>. Obviously this is not the best password to use in the real world. Therefore invent a strong password now. It should be different from the root password you chose in step 5 when you created the VPS. Our example will be <code>socKsecreT2021%d</code>.</p>
<h2 id="Download-Script"><a href="#Download-Script" class="headerlink" title="Download Script"></a>Download Script</h2><p>Download the script from GitHub by issuing this command in your terminal emulator:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>

<p>Make the script executable by issuing the command to set the execution bit:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>

<p><img src="/images/ss-chmod.png" alt="wget and chmod on shadowsocks script"></p>
<h2 id="Run-Script"><a href="#Run-Script" class="headerlink" title="Run Script"></a>Run Script</h2><p>Issue the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>
<p>The user password can be set by yourself or, if you do not set it. the default is <code>teddysun.com</code>. We chose <code>socKsecreT2021%d</code> as an example of setting the password yourself.</p>
<p><img src="/images/ss-password.png" alt="Script prompts for password"></p>
<p>You will be prompted for a server port. You can set it by yourself of you like. If you do not set it, the port number will be randomly generated from <code>9000</code> to <code>19999</code> by default.</p>
<p><img src="/images/ss-port.png" alt="Script prompts for port"></p>
<p>The encryption method can be set by yourself or, if you do not set it, the default is <code>aes-256-gcm</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1) aes-256-gcm</span><br><span class="line">2) aes-192-gcm</span><br><span class="line">3) aes-128-gcm</span><br><span class="line">4) aes-256-ctr</span><br><span class="line">5) aes-192-ctr</span><br><span class="line">6) aes-128-ctr</span><br><span class="line">7) aes-256-cfb</span><br><span class="line">8) aes-192-cfb</span><br><span class="line">9) aes-128-cfb</span><br><span class="line">10) camellia-128-cfb</span><br><span class="line">11) camellia-192-cfb</span><br><span class="line">12) camellia-256-cfb</span><br><span class="line">13) xchacha20-ietf-poly1305</span><br><span class="line">14) chacha20-ietf-poly1305</span><br><span class="line">15) chacha20-ietf</span><br><span class="line">16) chacha20</span><br><span class="line">17) salsa20</span><br><span class="line">18) rc4-md5</span><br></pre></td></tr></table></figure>

<p>We recommend you set the encryption method to <code>chacha20-ietf-poly1305</code>. This is a modern, AEAD cipher.</p>
<p><img src="/images/ss-cipher.png" alt="Script prompts for cipher"></p>
<p>Finally you are prompted to press any key to start, or <strong>Ctrl</strong>+<strong>c</strong> to cancel.</p>
<p>Shadowsocks-libev is compiled from source. This will take a few minutes.</p>
<p>After the installation is complete, the script prompts as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Congratulations, Shadowsocks-libev server install completed!</span><br><span class="line">Your Server IP: your_server_ip</span><br><span class="line">Your Server Port: your_server_port</span><br><span class="line">Your Password: your_password</span><br><span class="line">Your Encryption Method: your_encryption_method</span><br></pre></td></tr></table></figure>

<p><img src="/images/ss-completed.png" alt="Shadowsocks installation script completed"></p>
<p>Shadowsocks-libev has been set to start automatically on boot.</p>
<p>Now it’s time to log off the server:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><p>Switch to working on your PC. You can download the client for yout Windows PC from <a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-windows/releases">https://github.com/shadowsocks/shadowsocks-windows/releases</a>. Download the latest zip file. After it’s downloaded, extract the zip file.</p>
<p><img src="/images/ss-unzipped.png" alt="Shadowsocks client for Windows download unzipped"></p>
<p>Start the Shadowsocks application for the first time. For server IP, put the IP address of your server. The port to aim for is the port used by the server scrript. Put the password you chose on your server. Our example is <code>socKsecreT2021%d</code>. </p>
<p><img src="/images/ss-server.png" alt="Shadowsocks server definition on Windows client"></p>
<p><strong>Apply</strong> the settings, then click <strong>OK</strong>.</p>
<p>Find the Shadowsocks icon in the system tray. That’s at the bottom right of your Windows desktop. Right-click on the icon to bring up the Shadowsocks menu. Set the System Proxy to <strong>Global</strong>.</p>
<p><img src="/images/ss-global.png" alt="Shadowsocks system proxy set to Global mode"></p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><p>Open a browser and visit <a target="_blank" rel="noopener" href="https://whatismyipaddress.com/">https://whatismyipaddress.com</a>. It should look as though you are coming from the server’s IP address and location, not your PC’s address and location.</p>
<h2 id="Troubleshooting-and-Maintenance"><a href="#Troubleshooting-and-Maintenance" class="headerlink" title="Troubleshooting and Maintenance"></a>Troubleshooting and Maintenance</h2><p>You can view the status of Shadowsocks on your server with the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks status</span><br></pre></td></tr></table></figure>

<p>If you modify the server configuration file <code>/etc/shadowsocks-libev/config.json</code>, you can restart the Shadowsocks service with the command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks restart</span><br></pre></td></tr></table></figure>

<p>You can check Shadowsocks is listening with the commands:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install net-tools</span><br><span class="line"></span><br><span class="line">netstat -tulpn</span><br></pre></td></tr></table></figure>

<p>If an old version of Shadowsocks needs to be upgraded, you can download the latest version of this script and run it to automatically upgrade:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks-libev-debian.sh</span><br></pre></td></tr></table></figure>

<p>If you ever need to uninstall, log in to the server as the root user and run the following command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks-libev-debian.sh uninstall</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/09/19/Outline-of-Outline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/19/Outline-of-Outline/" class="post-title-link" itemprop="url">Outline of Outline</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-09-19 15:00:00" itemprop="dateCreated datePublished" datetime="2021-09-19T15:00:00-07:00">2021-09-19</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-09-24 10:38:00" itemprop="dateModified" datetime="2021-09-24T10:38:00-07:00">2021-09-24</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="What-is-Outline-VPN"><a href="#What-is-Outline-VPN" class="headerlink" title="What is Outline VPN?"></a>What is Outline VPN?</h2><p>Outline is a product of Google Jigsaw, a unit of Google that seeks to harness technology to promote an open society. Before being named Jigsaw, the unit was known as Google Ideas. It was founded in 2010 under Jared Cohen, formerly of the U.S. State Department.</p>
<p>Outline VPN consists of a server manager and a client. Outline Manager will handle any server provider, but it has special features to automate the process on DigitalOcean, Amazon Lightsail, and Google Cloud. Builds of the Server Manager are available for Windows, Linux, and macOS. The Outline Client is available for Android, Windows, Chrome, iOS, macOS, and Linux.</p>
<p>The official website for Outline VPN is Get Outline at <a target="_blank" rel="noopener" href="https://getoutline.org/">https://getoutline.org</a>.</p>
<h2 id="VPN-vs-Proxy-Server"><a href="#VPN-vs-Proxy-Server" class="headerlink" title="VPN vs. Proxy Server"></a>VPN vs. Proxy Server</h2><p>A virtual private network or VPN typically routes all application and all protocols through an encrypted tunnel to a remote server.</p>
<p>A proxy server typically applies only to your browser or other applications specifically configured to use a proxy server. </p>
<p>Outline is a VPN in that it creates a new software interface and routes all traffic over it. However, under the hood, Outline implements Shadowsocks, which if used by itself is a proxy server protected by encryption.</p>
<h2 id="Shadowsocks-vs-Outline"><a href="#Shadowsocks-vs-Outline" class="headerlink" title="Shadowsocks vs. Outline"></a>Shadowsocks vs. Outline</h2><p>Shadowsocks is the basis for Outline. It creates an encrypted tunnel between a Shadowsocks client and a Shadowsocks proxy server. Shadowsocks was created in 2012 by a Chinese programmer named clowwindy.</p>
<p>Since Outline runs on top of Shadowsocks, it can sometimes be quicker and more reliable simply to install Shadowsocks on your server and client instead of Outline. </p>
<p>If you do choose to run Shadowsocks itself, you can find best practices for configuration at <a target="_blank" rel="noopener" href="https://gfw.report/blog/ss_tutorial/en">https://gfw.report/blog/ss_tutorial/en</a>.</p>
<p>Some helpful links for installing Shadowsocks:</p>
<ul>
<li>Shadowsocks install script for the server <a target="_blank" rel="noopener" href="https://github.com/teddysun/shadowsocks_install/tree/master">https://github.com/teddysun/shadowsocks_install/tree/master</a></li>
<li>Shadowsocks client for Windows <a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-windows">https://github.com/shadowsocks/shadowsocks-windows</a></li>
</ul>
<h2 id="Outline-Manager"><a href="#Outline-Manager" class="headerlink" title="Outline Manager"></a>Outline Manager</h2><h3 id="Prepare-Server"><a href="#Prepare-Server" class="headerlink" title="Prepare Server"></a>Prepare Server</h3><p>Outline Manager runs on your PC but controls your Linux server.</p>
<p>Before beginning, make sure your server has high-numbered ports open for both TCP and UDP. Typically these are ports in the range 1024 through 65535.</p>
<h3 id="Install-Docker"><a href="#Install-Docker" class="headerlink" title="Install Docker"></a>Install Docker</h3><p>Outline Server Manager will attempt to install Docker on your server. You can also install Docker on the server yourself. The instructions to install Docker on Ubuntu are given at <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/ubuntu">https://docs.docker.com/engine/install/ubuntu</a>. For Ubuntu 20.04 they are as follows.</p>
<p>SSH into your server as <code>root</code>.</p>
<p><img src="/images/outline-1.png" alt="Windows PowerShell SSH"></p>
<p>Get the prerequisites:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt upgrade</span><br><span class="line"></span><br><span class="line">apt install apt-transport-https ca-certificates curl gnupg lsb-release</span><br></pre></td></tr></table></figure>

<p>Get the Docker signing key:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span><br></pre></td></tr></table></figure>

<p>Add the Docker repository to be signed by the Docker signing key:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot; | tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br></pre></td></tr></table></figure>

<p>Install Docker:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line"></span><br><span class="line">apt install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>

<p>Test your Docker install:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>

<p>The multiline output should include the lines:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br></pre></td></tr></table></figure>

<p><img src="/images/outline-2.png" alt="Docker hello-world"></p>
<h3 id="Install-and-Configure-Server"><a href="#Install-and-Configure-Server" class="headerlink" title="Install and Configure Server"></a>Install and Configure Server</h3><p>Now download to your PC the Outline Manager installer executable from the official website at <a target="_blank" rel="noopener" href="https://getoutline.org/">https://getoutline.org</a>.</p>
<p>Launch Outline Manager. Click OK to say that you agree to the Outline Terms of Service.</p>
<p>You are presented with a panel with four choices:</p>
<ul>
<li>DigitalOcean</li>
<li>Google Cloud Platform</li>
<li>Amazon Lightsail</li>
<li>Set up Outline anywhere</li>
</ul>
<p><img src="/images/outline-3.png" alt="Outline Manager VPS provider selection"></p>
<p>The “anywhere” option provides you with a command to run a script on your server:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &quot;$(wget -qO- https://raw.githubusercontent.com/Jigsaw-Code/outline-server/master/src/server_manager/install_scripts/install_server.sh)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/images/outline-4.png" alt="Outline Server Manager install script"></p>
<p>At the end of the script, a process named <code>outline-ss-server</code> is listening on randomly generated ports. TCP access is required for the management port, and both TCP and UDP for the client port. The file <code>/opt/outline/persisted-state/outline-ss-server/config.yml</code> contains the parameters for the client(s) in YAML format.</p>
<p>The output from the script will include lines that look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">To manage your Outline server, please copy the following line (including curly brackets) into Step 2 of the Outline Manager interface:</span><br><span class="line"></span><br><span class="line">&#123;&quot;apiUrl&quot;:&quot;https://XX.XX.XX.XX:YYYYY/4pvXtsIOLe3fiecYOEO6bw&quot;,&quot;certSha256&quot;:&quot;8D43979D44757F9ECE87C80F3E8C8A352964BDA8A3F65ABAB4A6F2C044DF0496&quot;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/outline-5.png" alt="Outline API URL"></p>
<p>You must copy and paste the resultant API URL line into the Outline Manager GUI panel.</p>
<p><img src="/images/outline-6.png" alt="Outline API URL in Server Manager"></p>
<p>After this, you can generate access keys for yourself and others.</p>
<p>The keys look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpPWW9QazFxcmtOTDA@XX.XX.XX.XX:ZZZZZ/?outline=1</span><br></pre></td></tr></table></figure>

<h2 id="Outline-Client-for-Windows"><a href="#Outline-Client-for-Windows" class="headerlink" title="Outline Client for Windows"></a>Outline Client for Windows</h2><p>Download the Outline Client from <a target="_blank" rel="noopener" href="https://getoutline.org/">https://getoutline.org</a>. On Windows, this gives you an installer, Outline-Client.exe. Run the installer.</p>
<p>Once the Outline Client is running, paste the Outline access key for the server into the Outline Client.</p>
<p>The Outline Client creates a TAP-Windows Adapter V9 named <code>outline-tap0</code>. You can view this in the Network Connections page of the Network and Sharing Center in the Control Panel. It also appears in the Device Manager in the Network adapter category.</p>
<p><img src="/images/outline-7.png" alt="Outline interface in Windows Device Manager"></p>
<p>Connect from the client to the server.</p>
<h3 id="Problems-with-TAP-Adapter-Not-Installing"><a href="#Problems-with-TAP-Adapter-Not-Installing" class="headerlink" title="Problems with TAP Adapter Not Installing"></a>Problems with TAP Adapter Not Installing</h3><p>There are sometimes problems on Windows with the TAP adapter not installing. This issue is documented at <a target="_blank" rel="noopener" href="https://github.com/Jigsaw-Code/outline-client/issues/761">https://github.com/Jigsaw-Code/outline-client/issues/761</a>.</p>
<p>The general principle is to uninstall the TAP-Windows Adapter V9 in the Device Manager in the Network adapter category. Also uninstall the Outline Client program in Control Panel. Then attempt to rerun the Outline Client installer.</p>
<h3 id="Unexpected-Error"><a href="#Unexpected-Error" class="headerlink" title="Unexpected Error"></a>Unexpected Error</h3><p>Outline Client sometimes creates problems marked “Unexpected error.”</p>
<p>On Windows, one possible cause is a missing Visual C++ Redistributable. This issue is documented at <a target="_blank" rel="noopener" href="https://github.com/Jigsaw-Code/outline-client/issues/782">https://github.com/Jigsaw-Code/outline-client/issues/782</a>. A user in that thread responds that the error was caused by missing DLLs. Running <code>vc_redist.x64.exe</code> and <code>vc_redist.x86.exe</code> solved the problem. The 32-bit version, <code>vc_redist.x86.exe</code>, is needed even on a 64-bit PC. You can find the DLLs from <a target="_blank" rel="noopener" href="https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads">https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads</a>.</p>
<h2 id="Outline-Client-for-Linux"><a href="#Outline-Client-for-Linux" class="headerlink" title="Outline Client for Linux"></a>Outline Client for Linux</h2><p>Download the Outline Client from <a target="_blank" rel="noopener" href="https://getoutline.org/">https://getoutline.org</a>. On Linux, the Outline Client is supplied as an AppImage file.</p>
<p>Make the AppImage executable:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Downloads</span><br><span class="line"></span><br><span class="line">chmod +x Outline-Client.AppImage</span><br></pre></td></tr></table></figure>

<p>Then just run the AppImage directly:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./Outline-Client.AppImage</span><br></pre></td></tr></table></figure>

<p>Outline Client creates an interface <code>outline-tun0</code>. It then changes the routing table so that this interface becomes the default route. This is what allows Outline to function as a VPN.</p>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h3><p>On the server side, you can view the logs with:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs shadowbox</span><br></pre></td></tr></table></figure>

<p>And see if Outline is listening with:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -tulpn</span><br></pre></td></tr></table></figure>

<p>For insoluble problems, consider installing Shadowsocks on server and client as a workaround.</p>
<h3 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h3><p>A user reports at <a target="_blank" rel="noopener" href="https://github.com/Jigsaw-Code/outline-client/issues/994">https://github.com/Jigsaw-Code/outline-client/issues/994</a> that you can sometimes get more information by running <code>c:\Program Files(x86)\Outline\outline.exe</code> from the command line.</p>
<p>You can also look in Windows Event Viewer (search for it in the Windows search box, or run <code>eventvwr</code>).</p>
<p>It may also be helpful to run Wireshark to see what is happening. Wireshark may be installed from <a target="_blank" rel="noopener" href="https://www.wireshark.org/">https://www.wireshark.org</a>.</p>
<p><img src="/images/outline-8.png" alt="Preparing to capture packets to and from a specific host in Wireshark"></p>
<p>If you cannot resolve the issue yourself, you can report it at <a target="_blank" rel="noopener" href="https://github.com/Jigsaw-Code/outline-client/issues">https://github.com/Jigsaw-Code/outline-client/issues</a>.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://seakfind.github.io/2021/09/18/Accessing-a-Shadowsocks-with-V2Ray-Plugin-Server-from-a-Linux-Client/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="seakfind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="seakfind">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/09/18/Accessing-a-Shadowsocks-with-V2Ray-Plugin-Server-from-a-Linux-Client/" class="post-title-link" itemprop="url">Accessing a Shadowsocks with V2Ray Plugin Server from a Linux Client</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-09-18 10:43:09 / Modified: 14:18:30" itemprop="dateCreated datePublished" datetime="2021-09-18T10:43:09-07:00">2021-09-18</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Download shadowsocks-rust for Linux 64-bit from <a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-rust/releases">GitHub</a>. Extract the contents of the archive.</p>
<p>Download the v2ray-plugin for Linux 64-bit from <a target="_blank" rel="noopener" href="https://github.com/shadowsocks/v2ray-plugin/releases">GitHub</a>. Copy the binary into the same folder as the extracted shadowsocks binaries.</p>
<p>Create a <code>config.json</code> file like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;your.host.name&quot;,</span><br><span class="line">    &quot;server_port&quot;:443,</span><br><span class="line">    &quot;local_address&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;: 1080,</span><br><span class="line">    &quot;password&quot;:&quot;yourshadowsocksserverpassword&quot;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;chacha20-ietf-poly1305&quot;,</span><br><span class="line">    &quot;plugin&quot;:&quot;./v2ray-plugin_linux_amd64&quot;,</span><br><span class="line">    &quot;plugin_opts&quot;:&quot;path=/yourpath;host=your.host.name;tls&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Start shadowsocks running:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./sslocal -c config.json</span><br></pre></td></tr></table></figure>

<p>Configure Firefox network settings to use the SOCKS5 proxy server that is now listening on 127.0.0.1 port 1080. Also set Firefox to proxy DNS queries over the SOCKS5 server.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">seakfind</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
